(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,a){},24:function(e,t,a){e.exports=a(51)},29:function(e,t,a){},30:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){},34:function(e,t,a){},35:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){},40:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){},51:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(20),c=a.n(s),i=(a(29),a(30),a(21)),o=a(11),l={toPostPara:function(e){var t="";for(var a in e)e.hasOwnProperty(a)&&(t=t+a+"="+e[a]+"&");return t.substring(0,t.length-1)}},d=(a(18),a(31),function(e){return r.a.createElement("div",{className:e.class,onClick:e.onClick}," ",e.text," ")}),m=function(){var e={username:"",password:""},t=function(t){var a=t.target.getAttribute("data-id");e[a]=t.target.value};return r.a.createElement("div",{className:"login"},r.a.createElement("div",{className:"login-title"}," \u6570\u636e\u5e93\u8bfe\u8bbe-12307\u706b\u8f66\u552e\u7968-\u767b\u5f55 "),r.a.createElement("input",{className:"login-input",placeholder:"\u7528\u6237\u540d","data-id":"username",onChange:t}),r.a.createElement("input",{className:"login-input",placeholder:"\u5bc6\u7801","data-id":"password",onChange:t}),r.a.createElement(d,{class:"login-button",onClick:function(){console.log("user login"),fetch("http://localhost:8080/TrainTickets/login",{method:"post",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l.toPostPara(e)}).then(function(e){return e.json()}).then(function(e){console.log("login",e),"1000"===e.statusCode?(localStorage.setItem("user",e.content),window.location.href="#/train"):"1001"===e.statusCode?alert("\u60a8\u88ab\u9650\u5236\u8d2d\u7968"):alert("\u60a8\u8f93\u5165\u7684\u8d26\u53f7\u5bc6\u7801\u4e0d\u6b63\u786e")})},text:"\u767b\u5f55"}),r.a.createElement("div",{className:"go-register",onClick:function(){window.location.href="#/register"}}," \u70b9\u51fb\u6b64\u5904\u6ce8\u518c\u65b0\u7528\u6237 "))},u=function(){var e={username:"",idcard:"",password:"",telephone:""},t=function(t){var a=t.target.getAttribute("data-id");e[a]=t.target.value};return r.a.createElement("div",{className:"login"},r.a.createElement("div",{className:"login-title"}," \u6570\u636e\u5e93\u8bfe\u8bbe-12307\u706b\u8f66\u552e\u7968-\u6ce8\u518c "),r.a.createElement("input",{className:"login-input",placeholder:"\u7528\u6237\u540d","data-id":"username",onChange:t}),r.a.createElement("input",{className:"login-input",placeholder:"\u5bc6\u7801","data-id":"password",onChange:t}),r.a.createElement("input",{className:"login-input",placeholder:"\u8eab\u4efd\u8bc1\u53f7","data-id":"idcard",onChange:t}),r.a.createElement("input",{className:"login-input",placeholder:"\u624b\u673a\u53f7","data-id":"telephone",onChange:t}),r.a.createElement(d,{class:"login-button",onClick:function(){console.log("user register"),fetch("http://localhost:8080/TrainTickets/register",{method:"post",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l.toPostPara(e)}).then(function(e){return e.json()}).then(function(e){console.log("register",e),"1000"===e.statusCode?(localStorage.setItem("user",e.content),window.location.href="#/train"):alert("\u51fa\u9519\u5566")})},text:"\u6ce8\u518c"}),r.a.createElement("div",{className:"go-register",onClick:function(){window.location.href="#/login"}}," \u70b9\u51fb\u6b64\u5904\u8fd4\u56de\u6ce8\u518c\u9875\u9762 "))},h=(a(32),function(){return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"title"},"12307-\u706b\u8f66\u7968\u552e\u7968\u7cfb\u7edf"),r.a.createElement(d,{class:"quit",onClick:function(){window.location.href="#/login"},text:"\u9000\u51fa"}))});a(33);var p=function(){return r.a.createElement("div",{className:"navigator",onClick:function(e){switch(e.target.getAttribute("data-id")){case"\u8f66\u7968":window.location.href="#/train";break;case"\u8ba2\u5355":window.location.href="#/order";break;case"\u6211\u7684":window.location.href="#/user"}}},r.a.createElement("div",{className:"navigator-content","data-id":"\u8f66\u7968"}," \u8f66\u7968 "),r.a.createElement("div",{className:"navigator-content","data-id":"\u8ba2\u5355"}," \u8ba2\u5355 "),r.a.createElement("div",{className:"navigator-content","data-id":"\u6211\u7684"}," \u6211\u7684 "))},f=a(6),v=a(7),E=a(10),g=a(8),N=a(2),y=a(9),C=(a(34),function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(E.a)(this,Object(g.a)(t).call(this,e))).fromChange=function(e){a.fromSelect=e.target.value},a.toChange=function(e){a.toSelect=e.target.value},a.dateChange=function(e){a.dateSelect=e.target.value},a.queryTrain=function(){var e={fromCity:a.city[a.fromSelect],toCity:a.city[a.toSelect],date:a.date[a.dateSelect]};a.fromSelect!==a.toSelect?(a.props.setTrainList([]),fetch("http://localhost:8080/TrainTickets/getTrainByStop",{method:"post",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l.toPostPara(e)}).then(function(e){return e.json()}).then(function(e){if(console.log("getTrainByStop",e),"1000"===e.statusCode){var t=JSON.parse(e.content);a.props.setTrainList(t,a.date[a.dateSelect]),0===t.length&&alert("\u65e0\u67e5\u8be2\u7ed3\u679c")}else alert("\u51fa\u9519\u5566")})):alert("\u4e0d\u53ef\u4ee5\u9009\u62e9\u540c\u4e00\u4e2a\u5730\u70b9")},a.queryTransfer=function(){var e={fromCity:a.city[a.fromSelect],toCity:a.city[a.toSelect],date:a.date[a.dateSelect]};a.fromSelect!==a.toSelect?(a.props.setTrainList([]),fetch("http://localhost:8080/TrainTickets/getTransfer",{method:"post",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l.toPostPara(e)}).then(function(e){return e.json()}).then(function(e){if(console.log("getTransfer",e),"1000"===e.statusCode){var t=JSON.parse(e.content);a.props.setTransferList(t),0===t.length&&alert("\u65e0\u67e5\u8be2\u7ed3\u679c")}else alert("\u51fa\u9519\u5566")})):alert("\u4e0d\u53ef\u4ee5\u9009\u62e9\u540c\u4e00\u4e2a\u5730\u70b9")},a.city=["\u6c88\u9633","\u6d4e\u5357","\u6df1\u5733","\u5317\u4eac","\u4e0a\u6d77","\u5e7f\u5dde","\u957f\u6625"],a.date=["2019-01-01","2019-01-02","2019-01-03"],a.fromSelect=0,a.toSelect=0,a.dateSelect=0,a.fromChange=a.fromChange.bind(Object(N.a)(a)),a.toChange=a.toChange.bind(Object(N.a)(a)),a.dateChange=a.dateChange.bind(Object(N.a)(a)),a.queryTrain=a.queryTrain.bind(Object(N.a)(a)),a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"city-select"},r.a.createElement("select",{className:"city-selector",defaultValue:"0",onChange:this.fromChange},r.a.createElement("option",{value:"0"}," ",this.city[0]," "),r.a.createElement("option",{value:"1"}," ",this.city[1]," "),r.a.createElement("option",{value:"2"}," ",this.city[2]," "),r.a.createElement("option",{value:"3"}," ",this.city[3]," "),r.a.createElement("option",{value:"4"}," ",this.city[4]," "),r.a.createElement("option",{value:"5"}," ",this.city[5]," "),r.a.createElement("option",{value:"6"}," ",this.city[6]," ")),r.a.createElement("div",{className:"city-selector-content"}," \u81f3 "),r.a.createElement("select",{className:"city-selector",defaultValue:"0",onChange:this.toChange},r.a.createElement("option",{value:"0"}," ",this.city[0]," "),r.a.createElement("option",{value:"1"}," ",this.city[1]," "),r.a.createElement("option",{value:"2"}," ",this.city[2]," "),r.a.createElement("option",{value:"3"}," ",this.city[3]," "),r.a.createElement("option",{value:"4"}," ",this.city[4]," "),r.a.createElement("option",{value:"5"}," ",this.city[5]," "),r.a.createElement("option",{value:"6"}," ",this.city[6]," ")),r.a.createElement("select",{className:"city-selector",defaultValue:"0",onChange:this.dateChange},r.a.createElement("option",{value:"0"}," ",this.date[0]," "),r.a.createElement("option",{value:"1"}," ",this.date[1]," "),r.a.createElement("option",{value:"2"}," ",this.date[2]," ")),r.a.createElement(d,{class:"train-tickets-button-default",text:"\u67e5\u8be2",onClick:this.queryTrain}),r.a.createElement(d,{class:"train-tickets-button-default",text:"\u6362\u4e58\u67e5\u8be2",onClick:this.queryTransfer}))}}]),t}(r.a.Component)),w=(a(35),function(){return r.a.createElement("div",{className:"train-select-detail"},r.a.createElement("div",{className:"train-select-item"}," \u706b\u8f66\u53f7"),r.a.createElement("div",{className:"train-select-item"}," \u53d1\u8f66\u65f6\u95f4 "),r.a.createElement("div",{className:"train-select-item"}," \u7968\u4ef7 "),r.a.createElement("div",{className:"train-select-item"}," \u4e00\u7b49\u5ea7 "),r.a.createElement("div",{className:"train-select-item"}," \u4e8c\u7b49\u5ea7 "),r.a.createElement("div",{className:"train-select-item"},"  "),r.a.createElement("div",{className:"train-select-item"},"  "))}),T=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(E.a)(this,Object(g.a)(t).call(this,e))).buyFirstClassTickets=function(){a.buyTickets(a.firstClassSeat[0])},a.buySecondClassTickets=function(){a.buyTickets(a.secondClassSeat[0])},a.buyTickets=function(e){var t=JSON.parse(localStorage.getItem("user")),n=a.props.train,r=a.props.date,s={userId:t.userId,passengerId:t.idcard,userName:t.userName,trainId:n.trainId,trainName:n.trainName,carriage:e.carriage,seatType:e.seatType,seatId:e.seatId,seatLocation:e.seatLocation,startTime:n.startTime,startStopId:n.startIndex,startStationName:n.start,endStopId:n.endIndex,endStationName:n.end,date:r,createAt:"2018-12-31",status:"\u5df2\u4ed8\u6b3e"};console.log(l.toPostPara(s)),fetch("http://localhost:8080/TrainTickets/lockSeat",{method:"post",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l.toPostPara(s)}).then(function(e){return e.json()}).then(function(e){if(console.log("lockSeat",e),"1000"===e.statusCode){var t=JSON.parse(e.content);alert("\u60a8\u5df2\u6210\u529f\u8d2d\u4e70 "+t.date+"\u7684"+t.trainName+"\u6b21\u5217\u8f66\uff0c\u60a8\u7684\u5ea7\u4f4d\u662f"+t.carriage+"\u8f66"+t.seatLocation),window.location.href="#/order"}else alert("\u51fa\u9519\u5566")})},a.firstClassSeat=[],a.secondClassSeat=[],a.buyTickets=a.buyTickets.bind(Object(N.a)(a)),a.state={first:"",second:""},a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=this,t={trainId:this.props.train.trainId,date:this.props.date,fromStopId:this.props.train.startIndex,toStopId:this.props.train.endIndex};fetch("http://localhost:8080/TrainTickets/getRemainSeats",{method:"post",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l.toPostPara(t)}).then(function(e){return e.json()}).then(function(t){if(console.log("getRemainSeats",t),"1000"===t.statusCode){e.firstClassSeat=[],e.secondClassSeat=[];var a=JSON.parse(t.content),n=!0,r=!1,s=void 0;try{for(var c,i=a[Symbol.iterator]();!(n=(c=i.next()).done);n=!0){var o=c.value;"\u4e00\u7b49\u5ea7"===o.seatType?e.firstClassSeat.push(o):"\u4e8c\u7b49\u5ea7"===o.seatType&&e.secondClassSeat.push(o)}}catch(l){r=!0,s=l}finally{try{n||null==i.return||i.return()}finally{if(r)throw s}}e.setState({first:e.firstClassSeat.length,second:e.secondClassSeat.length})}else alert("\u51fa\u9519\u5566")})}},{key:"render",value:function(){return r.a.createElement("div",{className:"train-select-detail"},r.a.createElement("div",{className:"train-select-item"}," ",this.props.train.trainName," "),r.a.createElement("div",{className:"train-select-item"}," ",this.props.train.startTime," "),r.a.createElement("div",{className:"train-select-item"}," ",this.props.date," "),r.a.createElement("div",{className:"train-select-item"}," ",this.state.first," "),r.a.createElement("div",{className:"train-select-item"}," ",this.state.second," "),r.a.createElement(d,{class:"train-tickets-button-default",text:"\u4e00\u7b49\u5ea7\u8d2d\u7968",onClick:this.buyFirstClassTickets}),r.a.createElement(d,{class:"train-tickets-button-default",text:"\u4e8c\u7b49\u5ea7\u8d2d\u7968",onClick:this.buySecondClassTickets}))}}]),t}(r.a.Component),b=function(e){var t=e.trainList.map(function(t,a){return r.a.createElement(T,{key:a,train:t,date:e.date})});return r.a.createElement("div",{className:"train-select"},r.a.createElement("div",{className:"train-select-title"}," \u67e5\u8be2\u7ed3\u679c\uff1a "),r.a.createElement(w,null),r.a.createElement("div",null," ",t," "))},S=(a(36),function(e){return r.a.createElement("div",{className:"transfer-select-detail"},r.a.createElement("div",{className:"transfer-select-item"}," ",e.transfer.firstTname," "),r.a.createElement("div",{className:"transfer-select-item"}," --\x3e "),r.a.createElement("div",{className:"transfer-select-item"}," ",e.transfer.transferStation," "),r.a.createElement("div",{className:"transfer-select-item"}," --\x3e "),r.a.createElement("div",{className:"transfer-select-item"}," ",e.transfer.secondTname," "))}),k=function(e){var t=e.transferList.map(function(e,t){return r.a.createElement(S,{key:t,transfer:e})});return r.a.createElement("div",{className:"transfer-select"},r.a.createElement("div",{className:"transfer-select-title"}," \u6362\u4e58\u7ed3\u679c\uff1a "),r.a.createElement("div",null," ",t," "))},O=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(E.a)(this,Object(g.a)(t).call(this,e))).setTrainList=function(e,t){a.setState({trainList:e,date:t,transferList:[]})},a.setTransferList=function(e){a.setState({trainList:[],date:"",transferList:e})},a.state={trainList:[],transferList:[],date:""},a.setTrainList=a.setTrainList.bind(Object(N.a)(a)),a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=null,t=null;return this.state.trainList.length>0&&(e=r.a.createElement(b,{trainList:this.state.trainList,date:this.state.date})),this.state.transferList.length>0&&(t=r.a.createElement(k,{transferList:this.state.transferList})),r.a.createElement("div",{className:"train"},r.a.createElement(C,{setTrainList:this.setTrainList,setTransferList:this.setTransferList}),e,t)}}]),t}(r.a.Component),j=(a(37),function(){return r.a.createElement("div",{className:"homepage"},r.a.createElement(h,null),r.a.createElement("div",{className:"content"},r.a.createElement(p,null),r.a.createElement(O,null)))}),L=(a(38),a(39),a(40),function(){return r.a.createElement("div",{className:"order-select-detail"},r.a.createElement("div",{className:"order-select-item"}," \u706b\u8f66\u53f7 "),r.a.createElement("div",{className:"order-select-item"}," \u53d1\u8f66\u65e5 "),r.a.createElement("div",{className:"order-select-item"}," \u53d1\u8f66\u65f6\u95f4 "),r.a.createElement("div",{className:"order-select-item"}," \u8d77\u6b62\u5730\u70b9 "),r.a.createElement("div",{className:"order-select-item"}," \u8f66\u53a2 "),r.a.createElement("div",{className:"order-select-item"}," \u5ea7\u4f4d\u53f7 "),r.a.createElement("div",{className:"order-select-item"},"  "))}),x=function(e){return r.a.createElement("div",{className:"order-select-detail"},r.a.createElement("div",{className:"order-select-item"}," ",e.order.trainName," "),r.a.createElement("div",{className:"order-select-item"}," ",e.order.date," "),r.a.createElement("div",{className:"order-select-item"}," ",e.order.startTime," "),r.a.createElement("div",{className:"order-select-item"}," ",e.order.startStationName+"-"+e.order.endStationName," "),r.a.createElement("div",{className:"order-select-item"}," ",e.order.carriage," "),r.a.createElement("div",{className:"order-select-item"}," ",e.order.seatLocation," "),r.a.createElement(d,{class:"train-tickets-button-default",text:"\u9000\u7968",onClick:function(){var t={orderId:e.order.orderId};fetch("http://localhost:8080/TrainTickets/deleteOrder",{method:"post",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l.toPostPara(t)}).then(function(e){return e.json()}).then(function(e){console.log("deleteOrder",e),"1000"===e.statusCode?(alert("\u5220\u9664\u6210\u529f"),window.location.href="#/train"):alert("\u51fa\u9519\u5566")})}}))},I=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(E.a)(this,Object(g.a)(t).call(this,e))).state={orderList:[]},a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=this,t={idcard:JSON.parse(localStorage.getItem("user")).idcard};fetch("http://localhost:8080/TrainTickets/queryOrder",{method:"post",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l.toPostPara(t)}).then(function(e){return e.json()}).then(function(t){console.log("queryOrder",t),"1000"===t.statusCode?e.setState({orderList:JSON.parse(t.content)}):alert("\u51fa\u9519\u5566")})}},{key:"render",value:function(){var e=this.state.orderList.map(function(e,t){return r.a.createElement(x,{order:e,key:t})});return r.a.createElement("div",{className:"order-detail"},r.a.createElement(L,null),e)}}]),t}(r.a.Component),P=function(){return r.a.createElement("div",{className:"homepage"},r.a.createElement(h,null),r.a.createElement("div",{className:"content"},r.a.createElement(p,null),r.a.createElement(I,null)))};a(41);var J=function(){var e=JSON.parse(localStorage.getItem("user"));function t(t){var a=t.target.getAttribute("data-id");e[a]=t.target.value}return r.a.createElement("div",{className:"user"},r.a.createElement("input",{className:"user-input",placeholder:"\u7528\u6237\u540d \u521d\u59cb\u503c\u4e3a: "+e.userName,"data-id":"username",onChange:t}),r.a.createElement("input",{className:"user-input",placeholder:"\u5bc6\u7801 \u521d\u59cb\u503c\u4e3a: "+e.password,"data-id":"password",onChange:t}),r.a.createElement("input",{className:"user-input",placeholder:"\u7535\u8bdd\u53f7\u7801 \u521d\u59cb\u503c\u4e3a: "+e.telephone,"data-id":"telephone",onChange:t}),r.a.createElement("input",{className:"user-input",placeholder:"\u8eab\u4efd\u8bc1\u53f7 \u521d\u59cb\u503c\u4e3a: "+e.idcard,"data-id":"idcard",onChange:t}),r.a.createElement("div",{className:"status-select"},r.a.createElement("div",{className:"status-select-text"}," \u9009\u62e9\u7528\u6237\u72b6\u6001\uff1a "),r.a.createElement("select",{className:"status-select-content","data-id":"status",defaultValue:"\u6b63\u5e38",onChange:t},r.a.createElement("option",{value:"\u6b63\u5e38"}," \u6b63\u5e38 "),r.a.createElement("option",{value:"\u9650\u5236\u8d2d\u7968"}," \u9650\u5236\u8d2d\u7968 "))),r.a.createElement(d,{class:"update-user",text:"\u4fee\u6539",onClick:function(){console.log("update user"),fetch("http://localhost:8080/TrainTickets/updateUser",{method:"post",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l.toPostPara(e)}).then(function(e){return e.json()}).then(function(e){console.log("updateUser",e),alert("\u4fee\u6539\u6210\u529f")})}}),r.a.createElement("div",{className:"tips"}," \u8fd9\u91cc\u7684\u4fee\u6539\u4ec5\u4f5c\u4e3a\u529f\u80fd\u6f14\u793a\uff0c\u4e3a\u4e86\u5176\u4ed6\u529f\u80fd\u7684\u6b63\u5e38\u8fd0\u884c\uff0c\u4e0d\u5e94\u8be5\u5bf9\u8eab\u4efd\u8bc1\u53f7\u548c\u7528\u6237\u540d\u8fdb\u884c\u66f4\u6539 "))},q=(a(42),function(){return r.a.createElement("div",{className:"homepage"},r.a.createElement(h,null),r.a.createElement("div",{className:"content"},r.a.createElement(p,null),r.a.createElement(J,null)))}),A=function(){return r.a.createElement(i.a,null,r.a.createElement(o.c,null,r.a.createElement(o.a,{exact:!0,path:"/",component:m}),r.a.createElement(o.a,{exact:!0,path:"/login",component:m}),r.a.createElement(o.a,{exact:!0,path:"/register",component:u}),r.a.createElement(o.a,{exact:!0,path:"/train",component:j}),r.a.createElement(o.a,{path:"/order",component:P}),r.a.createElement(o.a,{path:"/user",component:q})))},B=function(){return r.a.createElement("div",{className:"app"},r.a.createElement(A,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));localStorage.setItem("user","{}"),c.a.render(r.a.createElement(B,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[24,1,2]]]);
//# sourceMappingURL=main.5dc9ae5d.chunk.js.map